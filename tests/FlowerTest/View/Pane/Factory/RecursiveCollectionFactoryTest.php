<?php
namespace FlowerTest\View\Pane\Factory;

use Flower\Test\TestTool;
use Flower\View\Pane\Builder\Builder;
use Flower\View\Pane\Factory\RecursiveCollectionFactory;
use Flower\View\Pane\PaneClass\EntityScriptPane;

/**
 * Generated by PHPUnit_SkeletonGenerator 1.2.1 on 2014-02-14 at 23:13:34.
 */
class RecursiveCollectionFactoryTest extends \PHPUnit_Framework_TestCase
{
    /**
     * @covers Flower\View\Pane\Factory\RecursiveCollectionFactory::factory
     */
    public function testFactoryWithCollection()
    {
        $builder = new Builder;
        $data = array(
            new \stdClass,
            array('foo' => 'bar'),
        );
        $collection = new \RecursiveArrayIterator;
        $prototype = new EntityScriptPane;
        $paneConfig = array(
            'tag' => $tag = 'foo',
            'order' => $order = 5,
            'size' => $size = 10,
            'var' => $var = 'header',
            'classes' => $classes = 'container row',
            'collection' => $collection,
            'prototype' => $prototype,
            'attributes' => $attributes = array(
                'foo' => 'bar',
                'baz' => 'qux',
            ),
        );

        $pane = RecursiveCollectionFactory::factory($paneConfig, $builder);
        $this->assertInstanceOf('Flower\View\Pane\PaneClass\RecursiveCollection', $pane);
        $this->assertEquals('<foo>', $pane->containerBegin());
        $this->assertEquals('</foo>', $pane->containerEnd());
        $this->assertEquals($var, TestTool::getPropertyValue($pane, '_var'));
        $this->assertEquals($prototype, $pane->getPrototype());
        $this->assertEquals($collection->current(), $pane->current()->getEntity());

    }
}
